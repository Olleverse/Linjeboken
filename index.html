<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Linjebok + hastighetssträcka</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 18px; max-width: 780px; }
    h1 { font-size: 1.35rem; margin: 0 0 6px; }
    .muted { opacity: .75; font-size: .98rem; }
    .row { display: grid; grid-template-columns: 1fr; gap: 10px; margin-top: 14px; }
    input, textarea, select { width: 100%; box-sizing: border-box; padding: 12px; font-size: 1.05rem; border: 1px solid #ccc; border-radius: 10px; }
    button { padding: 12px 14px; border: 0; border-radius: 12px; font-size: 1.05rem; cursor: pointer; }
    button.primary { width: 100%; }
    button.small { padding: 10px 12px; font-size: 1rem; }
    .card { margin-top: 14px; padding: 14px; background: #f3f3f3; border-radius: 12px; }
    .line { padding: 10px 0; border-bottom: 1px solid #ddd; }
    .line:last-child { border-bottom: none; }
    .pillbar { display: flex; gap: 10px; margin-top: 10px; flex-wrap: wrap; }
    .pillbar button { background: #e9e9e9; }
    .admin { display:none; margin-top: 12px; }
    .admin h2 { font-size: 1.1rem; margin: 12px 0 8px; }
    .help { font-size: .95rem; opacity: .85; line-height: 1.35; }
    .two { display: grid; gap: 10px; grid-template-columns: 1fr; }
    @media (min-width: 760px) { .two { grid-template-columns: 1fr 1fr; } }
    code { background: rgba(0,0,0,.06); padding: 2px 6px; border-radius: 6px; }
    .ok { color: #0b6; font-weight: 600; }
    .warn { color: #b60; font-weight: 600; }
    .bad { color: #c00; font-weight: 700; }
    .divider { height: 1px; background: #ddd; margin: 10px 0; }
  </style>
</head>
<body>

  <h1>Linjebok + sträcka i hastighets-PDF</h1>
  <div class="muted">
    Skriv start/slut (kod eller namn). Appen visar vilken linjebok och vilka tabell-sträckor du ska slå upp i hastighets-PDF:en.
  </div>

  <div class="row">
    <input id="start" list="dpList" placeholder="Start (t.ex. Sk eller Skövde)" autocomplete="off" />
    <input id="slut"  list="dpList" placeholder="Slut (t.ex. G eller Göteborg)" autocomplete="off" />
    <datalist id="dpList"></datalist>

    <button class="primary" onclick="searchRoute()">Sök</button>
  </div>

  <div class="pillbar">
    <button class="small" onclick="requestAdmin()">Redigera data (PIN)</button>
    <button class="small" onclick="undoLastSave()">Ångra senaste sparning</button>
    <button class="small" onclick="resetToDefault()">Återställ standarddata</button>
  </div>

  <div id="output" class="card">Redo.</div>

  <div id="admin" class="admin card">
    <h2>Admin: Redigera dataset (sparas bara lokalt i din webbläsare)</h2>

    <div class="help">
      <strong>Så här matar du in utan kod:</strong><br>
      1) Linjebok: ID + namn<br>
      2) Driftplatser i ordning: en rad per driftplats: <code>KOD;Namn</code><br>
      3) Sträckor i hastighets-PDF: en rad per sträcka: <code>Sträcknamn|STARTKOD|SLUTKOD</code><br><br>
      <strong>Tips:</strong> Om någon råkar kladda kan du alltid trycka <em>Återställ standarddata</em> eller <em>Ångra senaste sparning</em>.
    </div>

    <div class="divider"></div>

    <div class="two">
      <div>
        <label><strong>Linjebok ID</strong></label>
        <input id="lbId" placeholder="t.ex. D5_Sk_G" />
      </div>
      <div>
        <label><strong>Linjebok namn</strong></label>
        <input id="lbName" placeholder="t.ex. TC Göteborg – Underlag..." />
      </div>
    </div>

    <div style="margin-top:10px;">
      <label><strong>Driftplatser i ordning</strong> (en per rad: <code>KOD;Namn</code>)</label>
      <textarea id="dpText" rows="10" placeholder="Sk;Skövde central&#10;..."></textarea>
    </div>

    <div style="margin-top:10px;">
      <label><strong>Sträckor i hastighets-PDF</strong> (en per rad: <code>Namn|START|SLUT</code>)</label>
      <textarea id="hsText" rows="8" placeholder="Skövde C – Partille|Sk|P&#10;Partille – Göteborg C|P|G"></textarea>
    </div>

    <div class="pillbar" style="margin-top:12px;">
      <button class="small" onclick="previewAdmin()">Förhandsgranska</button>
      <button class="small" onclick="saveAdmin()">Spara</button>
      <button class="small" onclick="hideAdmin()">Stäng</button>
    </div>

    <div id="adminMsg" class="muted" style="margin-top:10px;"></div>

    <div id="previewBox" class="card" style="display:none; margin-top:10px; background:#fff;">
      <div><strong>Förhandsgranskning</strong></div>
      <div id="previewContent" class="muted" style="margin-top:8px;"></div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
